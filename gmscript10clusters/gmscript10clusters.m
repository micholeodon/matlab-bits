% gmscript1 - unlabeled points (modified https://www.mathworks.com/help/stats/fitgmdist.html)
clear; close all; clc;
MAKE_COLORS = 0; % 1 - to enable separate colors for each cluster
PLOT_GAUSS = 1; % 1 - to plot gaussian contours

mu1 = [1 2];
mu2 = [-3 -5];
mu3 = [0 9];
mu4 = [-1 -7];
mu5 = [-4 -8];
mu6 = [-7 -5];
mu7 = [-6 5];
mu8 = [-4 0];
mu9 = [2 -2];
mu10 = [2 -7];
Sigma1 = [1 0; 0 0.5];
Sigma2 = [1 0;0 1];
Sigma3 = [0.2 0;0 0.4];
Sigma4 = [0.2 0;0 0.2];
Sigma5 = [0.3 0.5;0.5 1];
Sigma6 = [1 0.5;0.5 0.3];
Sigma7 = [0.6 -0.5;-0.5 0.6];
Sigma8 = [0.3 0;0 0.3];
Sigma9 = [0.4 0;0 0.4];
Sigma10 = [0.1 0;0 1];

rng(1); % For reproducibility
X = [mvnrnd(mu1,Sigma1,1000); ...
    mvnrnd(mu2, Sigma2, 1000); ...
    mvnrnd(mu3, Sigma3, 1000); ...
    mvnrnd(mu4, Sigma4, 1000); ...
    mvnrnd(mu5, Sigma5, 1000); ...
    mvnrnd(mu6, Sigma6, 1000); ...
    mvnrnd(mu7, Sigma7, 1000); ...
    mvnrnd(mu8, Sigma8, 1000); ...
    mvnrnd(mu9, Sigma9, 1000); ...
    mvnrnd(mu10, Sigma10, 1000)]; % https://www.mathworks.com/help/stats/mvnrnd.html

GMModel = fitgmdist(X,10);


figure
% color off
if(~MAKE_COLORS)
    y = [1*ones(1000,1); ...
        2*ones(1000,1); ...
        3*ones(1000,1); ...
        4*ones(1000,1); ...
        5*ones(1000,1); ...
        6*ones(1000,1); ...
        7*ones(1000,1); ...
        8*ones(1000,1); ...
        9*ones(1000,1); ...
        10*ones(1000,1)];
    h = gscatter(X(:,1),X(:,2),y, [0.67 0.67 0.67]);
end
% color on
if(MAKE_COLORS)
    y = [1*ones(1000,1); ...
        2*ones(1000,1); ...
        3*ones(1000,1); ...
        4*ones(1000,1); ...
        5*ones(1000,1); ...
        6*ones(1000,1); ...
        7*ones(1000,1); ...
        8*ones(1000,1); ...
        9*ones(1000,1); ...
        10*ones(1000,1)];
    h = gscatter(X(:,1),X(:,2),y);
end
xlim([-10 10])
ylim([-10 10])

if(PLOT_GAUSS)
    hold on
    f = @(x1,x2) pdf(GMModel,[x1 x2]);
    fc = fcontour(f);
    fc.LevelList = 0.005:0.005:0.03
    %fc.LevelList = 0:0.1:1;
    title('{\bf Scatter Plot and Fitted Gaussian Mixture Contours}')
    legend off
    hold off
end

